2019-04-29 09:53:23.043540: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA

post mean[[2.38067269 2.30258512 2.38067269 2.30258512 -10]]

post covariance (Chol decomp)[[[2.14596605 0 0 0 0][0 2.14596605 0 0 0][0 0 2.14596605 0 0][0 0 0 2.14596605 0][0 0 0 0 10]]]

post covariance[[[4.60517025 0 0 0 0][0 4.60517025 0 0 0][0 0 4.60517025 0 0][0 0 0 4.60517025 0][0 0 0 0 100]]]

post mean[[2.33067274 2.35258508 2.33067274 2.35258508 -9.95]]

post covariance (Chol decomp)[[[2.09298205 0 0 0 0][0 2.09298205 0 0 0][0 0 2.09298205 0 0][0 0 0 2.09298205 0][0 0 0 0 9.75309849]]]

post covariance[[[4.38057375 0 0 0 0][0 4.38057375 0 0 0][0 0 4.38057375 0 0][0 0 0 4.38057375 0][0 0 0 0 95.1229324]]]

post covariance[[[4.38057375 0 0 0 0][0 4.38057375 0 0 0][0 0 4.38057375 0 0][0 0 0 4.38057375 0][0 0 0 0 95.1229324]]]

post mean[[2.33067274 2.35258508 2.33067274 2.35258508 -9.95]]

post mean[[2.33067274 2.35258508 2.33067274 2.35258508 -9.95]]

post covariance (Chol decomp)[[[2.09298205 0 0 0 0][0 2.09298205 0 0 0][0 0 2.09298205 0 0][0 0 0 2.09298205 0][0 0 0 0 9.75309849]]]

post mean[[2.33067274 2.35258508 2.33067274 2.35258508 -9.95]]

post covariance (Chol decomp)[[[2.09298205 0 0 0 0][0 2.09298205 0 0 0][0 0 2.09298205 0 0][0 0 0 2.09298205 0][0 0 0 0 9.75309849]]]

post mean[[2.33067274 2.35258508 2.33067274 2.35258508 -9.95]]

post covariance (Chol decomp)[[[2.09298205 0 0 0 0][0 2.09298205 0 0 0][0 0 2.09298205 0 0][0 0 0 2.09298205 0][0 0 0 0 9.75309849]]]

post covariance[[[4.38057375 0 0 0 0][0 4.38057375 0 0 0][0 0 4.38057375 0 0][0 0 0 4.38057375 0][0 0 0 0 95.1229324]]]

post mean[[2.33067274 2.35258508 2.33067274 2.35258508 -9.95]]

post covariance (Chol decomp)[[[2.09298205 0 0 0 0][0 2.09298205 0 0 0][0 0 2.09298205 0 0][0 0 0 2.09298205 0][0 0 0 0 9.75309849]]]

post covariance[[[4.38057375 0 0 0 0][0 4.38057375 0 0 0][0 0 4.38057375 0 0][0 0 0 4.38057375 0][0 0 0 0 95.1229324]]]

post mean[[2.36777 2.31541657 2.29339838 2.38986754 -9.9127655]]

post covariance (Chol decomp)[[[2.05432844 0 0 0 0][0 2.13226557 0 0 0][0 0 2.05438495 0 0][0 0 0 2.05434227 0][0 0 0 0 9.57325554]]]

post covariance[[[4.22026539 0 0 0 0][0 4.54655647 0 0 0][0 0 4.22049761 0 0][0 0 0 4.22032213 0][0 0 0 0 91.6472244]]]

post mean[[2.36777 2.31541657 2.29339838 2.38986754 -9.9127655]]

post covariance[[[4.22026539 0 0 0 0][0 4.54655647 0 0 0][0 0 4.22049761 0 0][0 0 0 4.22032213 0][0 0 0 0 91.6472244]]]

post mean[[2.36777 2.31541657 2.29339838 2.38986754 -9.9127655]]

post covariance (Chol decomp)[[[2.05432844 0 0 0 0][0 2.13226557 0 0 0][0 0 2.05438495 0 0][0 0 0 2.05434227 0][0 0 0 0 9.57325554]]]

post mean[[2.36777 2.31541657 2.29339838 2.38986754 -9.9127655]]

post covariance (Chol decomp)[[[2.05432844 0 0 0 0][0 2.13226557 0 0 0][0 0 2.05438495 0 0][0 0 0 2.05434227 0][0 0 0 0 9.57325554]]]

post mean[[2.36777 2.31541657 2.29339838 2.38986754 -9.9127655]]

post covariance (Chol decomp)[[[2.05432844 0 0 0 0][0 2.13226557 0 0 0][0 0 2.05438495 0 0][0 0 0 2.05434227 0][0 0 0 0 9.57325554]]]

post covariance[[[4.22026539 0 0 0 0][0 4.54655647 0 0 0][0 0 4.22049761 0 0][0 0 0 4.22032213 0][0 0 0 0 91.6472244]]]

post mean[[2.36777 2.31541657 2.29339838 2.38986754 -9.9127655]]

post covariance (Chol decomp)[[[2.05432844 0 0 0 0][0 2.13226557 0 0 0][0 0 2.05438495 0 0][0 0 0 2.05434227 0][0 0 0 0 9.57325554]]]

post covariance[[[4.22026539 0 0 0 0][0 4.54655647 0 0 0][0 0 4.22049761 0 0][0 0 0 4.22032213 0][0 0 0 0 91.6472244]]]

post mean[[2.38533759 2.29188418 2.26456046 2.41869 -9.88306332]]

post covariance (Chol decomp)[[[2.01577759 0 0 0 0][0 2.16006589 0 0 0][0 0 2.02505255 0 0][0 0 0 2.02496457 0][0 0 0 0 9.43256]]]

post covariance[[[4.06335926 0 0 0 0][0 4.66588449 0 0 0][0 0 4.10083771 0 0][0 0 0 4.10048151 0][0 0 0 0 88.9731903]]]

post mean[[2.38533759 2.29188418 2.26456046 2.41869 -9.88306332]]

post covariance[[[4.06335926 0 0 0 0][0 4.66588449 0 0 0][0 0 4.10083771 0 0][0 0 0 4.10048151 0][0 0 0 0 88.9731903]]]

post mean[[2.38533759 2.29188418 2.26456046 2.41869 -9.88306332]]

post covariance (Chol decomp)[[[2.01577759 0 0 0 0][0 2.16006589 0 0 0][0 0 2.02505255 0 0][0 0 0 2.02496457 0][0 0 0 0 9.43256]]]

post covariance (Chol decomp)[[[2.01577759 0 0 0 0][0 2.16006589 0 0 0][0 0 2.02505255 0 0][0 0 0 2.02496457 0][0 0 0 0 9.43256]]]

post mean[[2.38533759 2.29188418 2.26456046 2.41869 -9.88306332]]

post covariance (Chol decomp)[[[2.01577759 0 0 0 0][0 2.16006589 0 0 0][0 0 2.02505255 0 0][0 0 0 2.02496457 0][0 0 0 0 9.43256]]]

post mean[[2.38533759 2.29188418 2.26456046 2.41869 -9.88306332]]

post covariance[[[4.06335926 0 0 0 0][0 4.66588449 0 0 0][0 0 4.10083771 0 0][0 0 0 4.10048151 0][0 0 0 0 88.9731903]]]

post covariance (Chol decomp)[[[2.01577759 0 0 0 0][0 2.16006589 0 0 0][0 0 2.02505255 0 0][0 0 0 2.02496457 0][0 0 0 0 9.43256]]]

post mean[[2.38533759 2.29188418 2.26456046 2.41869 -9.88306332]]

post covariance[[[4.06335926 0 0 0 0][0 4.66588449 0 0 0][0 0 4.10083771 0 0][0 0 0 4.10048151 0][0 0 0 0 88.9731903]]]

post mean[[2.35629702 2.32092595 2.23255301 2.4480691 -9.85381]]

post covariance (Chol decomp)[[[1.986691 0 0 0 0][0 2.19186616 0 0 0][0 0 1.98788404 0 0][0 0 0 2.05347919 0][0 0 0 0 9.29574299]]]

post covariance[[[3.94694114 0 0 0 0][0 4.80427742 0 0 0][0 0 3.95168304 0 0][0 0 0 4.21677685 0][0 0 0 0 86.4108353]]]

post mean[[2.35629702 2.32092595 2.23255301 2.4480691 -9.85381]]

post covariance[[[3.94694114 0 0 0 0][0 4.80427742 0 0 0][0 0 3.95168304 0 0][0 0 0 4.21677685 0][0 0 0 0 86.4108353]]]

post mean[[2.35629702 2.32092595 2.23255301 2.4480691 -9.85381]]

post covariance (Chol decomp)[[[1.986691 0 0 0 0][0 2.19186616 0 0 0][0 0 1.98788404 0 0][0 0 0 2.05347919 0][0 0 0 0 9.29574299]]]

post covariance (Chol decomp)[[[1.986691 0 0 0 0][0 2.19186616 0 0 0][0 0 1.98788404 0 0][0 0 0 2.05347919 0][0 0 0 0 9.29574299]]]

post mean[[2.35629702 2.32092595 2.23255301 2.4480691 -9.85381]]

post mean[[2.35629702 2.32092595 2.23255301 2.4480691 -9.85381]]

post covariance (Chol decomp)[[[1.986691 0 0 0 0][0 2.19186616 0 0 0][0 0 1.98788404 0 0][0 0 0 2.05347919 0][0 0 0 0 9.29574299]]]

post covariance[[[3.94694114 0 0 0 0][0 4.80427742 0 0 0][0 0 3.95168304 0 0][0 0 0 4.21677685 0][0 0 0 0 86.4108353]]]

post mean[[2.35629702 2.32092595 2.23255301 2.4480691 -9.85381]]

post covariance (Chol decomp)[[[1.986691 0 0 0 0][0 2.19186616 0 0 0][0 0 1.98788404 0 0][0 0 0 2.05347919 0][0 0 0 0 9.29574299]]]

post covariance[[[3.94694114 0 0 0 0][0 4.80427742 0 0 0][0 0 3.95168304 0 0][0 0 0 4.21677685 0][0 0 0 0 86.4108353]]]

post mean[[2.33176 2.34543228 2.2064755 2.47239399 -9.82838917]]

post covariance (Chol decomp)[[[1.96243513 0 0 0 0][0 2.21877265 0 0 0][0 0 1.95573401 0 0][0 0 0 2.07819176 0][0 0 0 0 9.17824268]]]

post covariance[[[3.8511517 0 0 0 0][0 4.92295218 0 0 0][0 0 3.82489562 0 0][0 0 0 4.31888103 0][0 0 0 0 84.2401352]]]

post covariance[[[3.8511517 0 0 0 0][0 4.92295218 0 0 0][0 0 3.82489562 0 0][0 0 0 4.31888103 0][0 0 0 0 84.2401352]]]

post mean[[2.33176 2.34543228 2.2064755 2.47239399 -9.82838917]]

post mean[[2.33176 2.34543228 2.2064755 2.47239399 -9.82838917]]

post covariance (Chol decomp)[[[1.96243513 0 0 0 0][0 2.21877265 0 0 0][0 0 1.95573401 0 0][0 0 0 2.07819176 0][0 0 0 0 9.17824268]]]

post mean[[2.33176 2.34543228 2.2064755 2.47239399 -9.82838917]]

post covariance (Chol decomp)[[[1.96243513 0 0 0 0][0 2.21877265 0 0 0][0 0 1.95573401 0 0][0 0 0 2.07819176 0][0 0 0 0 9.17824268]]]

post covariance (Chol decomp)[[[1.96243513 0 0 0 0][0 2.21877265 0 0 0][0 0 1.95573401 0 0][0 0 0 2.07819176 0][0 0 0 0 9.17824268]]]

post mean[[2.33176 2.34543228 2.2064755 2.47239399 -9.82838917]]

post covariance[[[3.8511517 0 0 0 0][0 4.92295218 0 0 0][0 0 3.82489562 0 0][0 0 0 4.31888103 0][0 0 0 0 84.2401352]]]

post mean[[2.33176 2.34543228 2.2064755 2.47239399 -9.82838917]]

post covariance (Chol decomp)[[[1.96243513 0 0 0 0][0 2.21877265 0 0 0][0 0 1.95573401 0 0][0 0 0 2.07819176 0][0 0 0 0 9.17824268]]]

post covariance[[[3.8511517 0 0 0 0][0 4.92295218 0 0 0][0 0 3.82489562 0 0][0 0 0 4.31888103 0][0 0 0 0 84.2401352]]]

post mean[[2.31061268 2.36655259 2.18401837 2.49335027 -9.80647564]]

post covariance (Chol decomp)[[[1.94176626 0 0 0 0][0 2.24223 0 0 0][0 0 1.92841983 0 0][0 0 0 2.09974933 0][0 0 0 0 9.07815]]]

post covariance[[[3.77045631 0 0 0 0][0 5.02759504 0 0 0][0 0 3.71880293 0 0][0 0 0 4.40894747 0][0 0 0 0 82.4128]]]

post mean[[2.31061268 2.36655259 2.18401837 2.49335027 -9.80647564]]

post covariance[[[3.77045631 0 0 0 0][0 5.02759504 0 0 0][0 0 3.71880293 0 0][0 0 0 4.40894747 0][0 0 0 0 82.4128]]]

post mean[[2.31061268 2.36655259 2.18401837 2.49335027 -9.80647564]]

post covariance (Chol decomp)[[[1.94176626 0 0 0 0][0 2.24223 0 0 0][0 0 1.92841983 0 0][0 0 0 2.09974933 0][0 0 0 0 9.07815]]]

post mean[[2.31061268 2.36655259 2.18401837 2.49335027 -9.80647564]]

post covariance (Chol decomp)[[[1.94176626 0 0 0 0][0 2.24223 0 0 0][0 0 1.92841983 0 0][0 0 0 2.09974933 0][0 0 0 0 9.07815]]]

post mean[[2.31061268 2.36655259 2.18401837 2.49335027 -9.80647564]]

post covariance (Chol decomp)[[[1.94176626 0 0 0 0][0 2.24223 0 0 0][0 0 1.92841983 0 0][0 0 0 2.09974933 0][0 0 0 0 9.07815]]]

post covariance[[[3.77045631 0 0 0 0][0 5.02759504 0 0 0][0 0 3.71880293 0 0][0 0 0 4.40894747 0][0 0 0 0 82.4128]]]

post mean[[2.31061268 2.36655259 2.18401837 2.49335027 -9.80647564]]

post covariance (Chol decomp)[[[1.94176626 0 0 0 0][0 2.24223 0 0 0][0 0 1.92841983 0 0][0 0 0 2.09974933 0][0 0 0 0 9.07815]]]

post covariance[[[3.77045631 0 0 0 0][0 5.02759504 0 0 0][0 0 3.71880293 0 0][0 0 0 4.40894747 0][0 0 0 0 82.4128]]]

post mean[[2.29212856 2.3850069 2.16402745 2.51179647 -9.78732]]

post covariance (Chol decomp)[[[1.92388868 0 0 0 0][0 2.26283312 0 0 0][0 0 1.90459073 0 0][0 0 0 2.11851 0][0 0 0 0 8.99156761]]]

post covariance[[[3.70134759 0 0 0 0][0 5.12041378 0 0 0][0 0 3.62746572 0 0][0 0 0 4.48808479 0][0 0 0 0 80.8482895]]]

post mean[[2.29212856 2.3850069 2.16402745 2.51179647 -9.78732]]

post covariance[[[3.70134759 0 0 0 0][0 5.12041378 0 0 0][0 0 3.62746572 0 0][0 0 0 4.48808479 0][0 0 0 0 80.8482895]]]

post mean[[2.29212856 2.3850069 2.16402745 2.51179647 -9.78732]]

post covariance (Chol decomp)[[[1.92388868 0 0 0 0][0 2.26283312 0 0 0][0 0 1.90459073 0 0][0 0 0 2.11851 0][0 0 0 0 8.99156761]]]

post mean[[2.29212856 2.3850069 2.16402745 2.51179647 -9.78732]]

post covariance (Chol decomp)[[[1.92388868 0 0 0 0][0 2.26283312 0 0 0][0 0 1.90459073 0 0][0 0 0 2.11851 0][0 0 0 0 8.99156761]]]

post mean[[2.29212856 2.3850069 2.16402745 2.51179647 -9.78732]]

post covariance (Chol decomp)[[[1.92388868 0 0 0 0][0 2.26283312 0 0 0][0 0 1.90459073 0 0][0 0 0 2.11851 0][0 0 0 0 8.99156761]]]

post covariance[[[3.70134759 0 0 0 0][0 5.12041378 0 0 0][0 0 3.62746572 0 0][0 0 0 4.48808479 0][0 0 0 0 80.8482895]]]

post mean[[2.29212856 2.3850069 2.16402745 2.51179647 -9.78732]]

post covariance (Chol decomp)[[[1.92388868 0 0 0 0][0 2.26283312 0 0 0][0 0 1.90459073 0 0][0 0 0 2.11851 0][0 0 0 0 8.99156761]]]

post covariance[[[3.70134759 0 0 0 0][0 5.12041378 0 0 0][0 0 3.62746572 0 0][0 0 0 4.48808479 0][0 0 0 0 80.8482895]]]

post mean[[2.27582908 2.40127778 2.14640427 2.52805781 -9.77042866]]

post covariance (Chol decomp)[[[1.90826118 0 0 0 0][0 2.28110242 0 0 0][0 0 1.8838284 0 0][0 0 0 2.13518786 0][0 0 0 0 8.91591454]]]

post covariance[[[3.64146066 0 0 0 0][0 5.20342827 0 0 0][0 0 3.54880953 0 0][0 0 0 4.55902719 0][0 0 0 0 79.4935303]]]

post mean[[2.27582908 2.40127778 2.14640427 2.52805781 -9.77042866]]

post covariance[[[3.64146066 0 0 0 0][0 5.20342827 0 0 0][0 0 3.54880953 0 0][0 0 0 4.55902719 0][0 0 0 0 79.4935303]]]

post mean[[2.27582908 2.40127778 2.14640427 2.52805781 -9.77042866]]

post covariance (Chol decomp)[[[1.90826118 0 0 0 0][0 2.28110242 0 0 0][0 0 1.8838284 0 0][0 0 0 2.13518786 0][0 0 0 0 8.91591454]]]

post mean[[2.27582908 2.40127778 2.14640427 2.52805781 -9.77042866]]

post covariance (Chol decomp)[[[1.90826118 0 0 0 0][0 2.28110242 0 0 0][0 0 1.8838284 0 0][0 0 0 2.13518786 0][0 0 0 0 8.91591454]]]

post mean[[2.27582908 2.40127778 2.14640427 2.52805781 -9.77042866]]

post covariance (Chol decomp)[[[1.90826118 0 0 0 0][0 2.28110242 0 0 0][0 0 1.8838284 0 0][0 0 0 2.13518786 0][0 0 0 0 8.91591454]]]

post covariance[[[3.64146066 0 0 0 0][0 5.20342827 0 0 0][0 0 3.54880953 0 0][0 0 0 4.55902719 0][0 0 0 0 79.4935303]]]

post mean[[2.27582908 2.40127778 2.14640427 2.52805781 -9.77042866]]

post covariance (Chol decomp)[[[1.90826118 0 0 0 0][0 2.28110242 0 0 0][0 0 1.8838284 0 0][0 0 0 2.13518786 0][0 0 0 0 8.91591454]]]

post covariance[[[3.64146066 0 0 0 0][0 5.20342827 0 0 0][0 0 3.54880953 0 0][0 0 0 4.55902719 0][0 0 0 0 79.4935303]]]

post mean[[2.26135778 2.41572475 2.1305337 2.54263353 -9.75542736]]

post covariance (Chol decomp)[[[1.89449358 0 0 0 0][0 2.29744 0 0 0][0 0 1.86504722 0 0][0 0 0 2.1499052 0][0 0 0 0 8.84927273]]]

post covariance[[[3.58910584 0 0 0 0][0 5.27823067 0 0 0][0 0 3.47840118 0 0][0 0 0 4.62209225 0][0 0 0 0 78.3096313]]]

post mean[[2.26135778 2.41572475 2.1305337 2.54263353 -9.75542736]]

post covariance[[[3.58910584 0 0 0 0][0 5.27823067 0 0 0][0 0 3.47840118 0 0][0 0 0 4.62209225 0][0 0 0 0 78.3096313]]]

post mean[[2.26135778 2.41572475 2.1305337 2.54263353 -9.75542736]]

post covariance (Chol decomp)[[[1.89449358 0 0 0 0][0 2.29744 0 0 0][0 0 1.86504722 0 0][0 0 0 2.1499052 0][0 0 0 0 8.84927273]]]

post mean[[2.26135778 2.41572475 2.1305337 2.54263353 -9.75542736]]

post covariance (Chol decomp)[[[1.89449358 0 0 0 0][0 2.29744 0 0 0][0 0 1.86504722 0 0][0 0 0 2.1499052 0][0 0 0 0 8.84927273]]]

post mean[[2.26135778 2.41572475 2.1305337 2.54263353 -9.75542736]]

post covariance (Chol decomp)[[[1.89449358 0 0 0 0][0 2.29744 0 0 0][0 0 1.86504722 0 0][0 0 0 2.1499052 0][0 0 0 0 8.84927273]]]

post covariance[[[3.58910584 0 0 0 0][0 5.27823067 0 0 0][0 0 3.47840118 0 0][0 0 0 4.62209225 0][0 0 0 0 78.3096313]]]

post mean[[2.26135778 2.41572475 2.1305337 2.54263353 -9.75542736]]

post covariance (Chol decomp)[[[1.89449358 0 0 0 0][0 2.29744 0 0 0][0 0 1.86504722 0 0][0 0 0 2.1499052 0][0 0 0 0 8.84927273]]]

post covariance[[[3.58910584 0 0 0 0][0 5.27823067 0 0 0][0 0 3.47840118 0 0][0 0 0 4.62209225 0][0 0 0 0 78.3096313]]]

post mean[[2.2484405 2.42861986 2.11641693 2.55564117 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.84839487 0 0][0 0 0 2.16313791 0][0 0 0 0 8.79018]]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.41656351 0 0][0 0 0 4.67916584 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.11641693 2.55564117 -9.74202919]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.41656351 0 0][0 0 0 4.67916584 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.11641693 2.55564117 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.84839487 0 0][0 0 0 2.16313791 0][0 0 0 0 8.79018]]]

post mean[[2.2484405 2.42861986 2.11641693 2.55564117 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.84839487 0 0][0 0 0 2.16313791 0][0 0 0 0 8.79018]]]

post mean[[2.2484405 2.42861986 2.11641693 2.55564117 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.84839487 0 0][0 0 0 2.16313791 0][0 0 0 0 8.79018]]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.41656351 0 0][0 0 0 4.67916584 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.11641693 2.55564117 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.84839487 0 0][0 0 0 2.16313791 0][0 0 0 0 8.79018]]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.41656351 0 0][0 0 0 4.67916584 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.11641693 2.55564117 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.84839487 0 0][0 0 0 2.16313791 0][0 0 0 0 8.79018]]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.41656351 0 0][0 0 0 4.67916584 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.09229541 2.56736445 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.82621694 0 0][0 0 0 2.17521739 0][0 0 0 0 8.79018]]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.33506823 0 0][0 0 0 4.73157072 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.09229541 2.56736445 -9.74202919]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.33506823 0 0][0 0 0 4.73157072 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.09229541 2.56736445 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.82621694 0 0][0 0 0 2.17521739 0][0 0 0 0 8.79018]]]

post mean[[2.2484405 2.42861986 2.09229541 2.56736445 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.82621694 0 0][0 0 0 2.17521739 0][0 0 0 0 8.79018]]]

post mean[[2.2484405 2.42861986 2.09229541 2.56736445 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.82621694 0 0][0 0 0 2.17521739 0][0 0 0 0 8.79018]]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.33506823 0 0][0 0 0 4.73157072 0][0 0 0 0 77.2672653]]]

post mean[[2.2484405 2.42861986 2.09229541 2.56736445 -9.74202919]]

post covariance (Chol decomp)[[[1.88228929 0 0 0 0][0 2.31209946 0 0 0][0 0 1.82621694 0 0][0 0 0 2.17521739 0][0 0 0 0 8.79018]]]

post covariance[[[3.54301286 0 0 0 0][0 5.34580374 0 0 0][0 0 3.33506823 0 0][0 0 0 4.73157072 0][0 0 0 0 77.2672653]]]

post mean[[-nan -nan 2.07060695 2.57790232 -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan 2.07060695 2.57790232 -nan]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan 2.07060695 2.57790232 -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post mean[[-nan -nan 2.07060695 2.57790232 -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post mean[[-nan -nan 2.07060695 2.57790232 -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan 2.07060695 2.57790232 -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post mean[[-nan -nan -nan -nan -nan]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post mean[[-nan -nan -nan -nan -nan]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)

post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]


post covariance (Chol decomp)[[[-nan 0 0 0 0][0 -nan 0 0 0][0 0 1.80650318 0 0][0 0 0 2.18613076 0][0 0 0 0 -nan]]]

post covariance[[[-nan -nan -nan -nan -nan][-nan -nan -nan -nan -nan][-nan -nan 3.26345372 0 -nan][-nan -nan 0 4.77916765 -nan][-nan -nan -nan -nan -nan]]]

post mean[[-nan -nan -nan -nan -nan]]
Traceback (most recent call last):
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 304, in train
    cost = np.mean(self.fit_batch())
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 232, in fit_batch
    _, cost = self.sess.run([self.optimize, self.mean_cost], feed_dict=self.feed_dict)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1291, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Caused by op 'gradients/post_det_grad/MatrixInverse', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 40, in test_biexp_single
    svb = SvbFit(model, mode_corr='no_post_corr', debug=False)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 210, in _create_loss_optimizer
    self.optimize = self.optimizer.minimize(self.mean_cost)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 400, in minimize
    grad_loss=grad_loss)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 514, in compute_gradients
    colocate_gradients_with_ops=colocate_gradients_with_ops)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 596, in gradients
    gate_gradients, aggregation_method, stop_gradients)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in _GradientsHelper
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 398, in _MaybeCompile
    return grad_fn()  # Exit early
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py", line 779, in <lambda>
    lambda: grad_fn(op, *out_grads))
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/linalg_grad.py", line 51, in _MatrixDeterminantGrad
    a_adj_inv = linalg_ops.matrix_inverse(a, adjoint=True)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 1049, in matrix_inverse
    "MatrixInverse", input=input, adjoint=adjoint, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

...which was originally created as op 'post_det', defined at:
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
[elided 1 identical lines from previous traceback]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 92, in __init__
    self._create_loss_optimizer()
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 185, in _create_loss_optimizer
    latent_loss = self.post.entropy() - self.prior.mean_log_pdf(samples)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/dist.py", line 246, in entropy
    det_covar = tf.matrix_determinant(self.cov, name="%s_det" % self.name) # [NV]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/ops/gen_linalg_ops.py", line 909, in matrix_determinant
    "MatrixDeterminant", input=input, name=name)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 454, in new_func
    return func(*args, **kwargs)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3155, in create_op
    op_def=op_def)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1717, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: gradients/post_det_grad/MatrixInverse = MatrixInverse[T=DT_FLOAT, adjoint=true, _device="/job:localhost/replica:0/task:0/device:CPU:0"](Print_1)]]

Traceback (most recent call last):
  File "test_biexp.py", line 155, in <module>
    test_biexp_single()
  File "test_biexp.py", line 41, in test_biexp_single
    time, ret = runtime(svb.train, t, x, batch_size=batch_size, training_epochs=training_epochs, learning_rate=learning_rate, fit_only_epochs=200)
  File "test_biexp.py", line 138, in runtime
    ret = runnable(*args, **kwargs)
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 320, in train
    params = self.output("post_mean_model") # [P, NV]
  File "/home/ibmeuser/ibmecode/build_scripts/build/svb/svb.py", line 241, in output
    return self.sess.run((self.sess.graph.get_tensor_by_name("%s:0" % name),), feed_dict=self.feed_dict)[0]
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 877, in run
    run_metadata_ptr)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1272, in _do_run
    run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1278, in _do_call
    return fn(*args)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1263, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/ibmeuser/.conda/envs/svb/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _call_tf_sessionrun
    run_metadata)
KeyboardInterrupt
